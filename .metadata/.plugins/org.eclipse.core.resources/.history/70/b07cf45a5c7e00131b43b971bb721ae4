package wordLadderII;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;

public class SaveVistiedStatusAfterEachLevel {
    public static ArrayList<ArrayList<String>> findLadders(String start, String end, HashSet<String> dict) {
        ArrayList<ArrayList<String>> results = new ArrayList<ArrayList<String>>();
        ArrayList<String> level = new ArrayList<String>();
        level.add(start);
        if (start.equals(end)) {
            results.add(level);
            return results;
        }
        
        HashSet<String> visited = new HashSet<String>();
        visited.add(start);
        
        HashMap<String, ArrayList<String>> map = new HashMap<String, ArrayList<String>>();
        
        while (!level.isEmpty()) {
            ArrayList<String> tmp = new ArrayList<String>();
            for (String s : level) {
                helper(s, end, map, visited, dict, tmp);
            }
            
            for (String s : tmp) {
                visited.add(s);
            }
            
            if (visited.contains(end)) {
                ArrayList<String> result = new ArrayList<String>();
                result.add(end);
                backTrack(results, end, start, map, result);
                return results;
            } else {
                level = tmp;
            }
        }
        
        return results;
    }
    
    private static void backTrack(ArrayList<ArrayList<String>> results, String prev, String start, HashMap<String, ArrayList<String>> map, ArrayList<String> result) {
        if (prev.equals(start)) {
            result.add(0, start);
            results.add(new ArrayList<String>(result));
        } else {
            ArrayList<String> parents = map.get(prev);
            for (String s : parents) {
                result.add(0, s);
                backTrack(results, s, start, map, result);
                result.remove(0);
            }
        }
    }
    
    private static void helper(String s, String end, HashMap<String, ArrayList<String>> map, HashSet<String> visited, HashSet<String> dict, ArrayList<String> tmp) {
        for (int i = 0; i < s.length(); i++) {
            char[] word = s.toCharArray();
            
            for (char c = 'a'; c <= 'z'; c++) {
                word[i] = c;
                String w = new String(word);
                if (!visited.contains(w) && (dict.contains(w) || w.equals(end))) {
                    tmp.add(w);
                    if (map.containsKey(w)) {
                        map.get(w).add(s);
                    } else {
                        ArrayList<String> parents = new ArrayList<String>();
                        parents.add(s);
                        map.put(w, parents);
                    }
                }
            }
        }
    }
    
	public static void main(String[] args) {
		String start = "hit";
		String end = "cog";
		HashSet<String> dict = new HashSet<String>();
//		dict.add("hot");
//		dict.add("dot");
//		dict.add("dog");
//		dict.add("lot");
//		dict.add("log");
//		ArrayList<ArrayList<String>> ladders = new ArrayList<ArrayList<String>>();
//		ladders = findLadders(start, end, dict);
//		for (ArrayList<String> ladder: ladders) {
//			System.out.println(ladder);
//		}
//		System.out.println();
		start = "a";
		end = "c";
		dict = new HashSet<String>();
		dict.add("a");
		dict.add("b");
		dict.add("c");
		
		ladders = findLadders(start, end, dict);
		for (ArrayList<String> ladder: ladders) {
			System.out.println(ladder);
		}
		System.out.println();
//		start = "hot";
//		end = "dog";
//		dict = new HashSet<String>();
//
//		dict.add("hot");
//		dict.add("dog");
//		
//		ladders = findLadders(start, end, dict);
//		for (ArrayList<String> ladder: ladders) {
//			System.out.println(ladder);
//		}
//		System.out.println();
//		start = "hot";
//		end = "dog";
//		dict = new HashSet<String>();
//		dict.add("hot");
//		dict.add("dot");
//		dict.add("dog");
//		
//
//		ladders = findLadders(start, end, dict);
//		for (ArrayList<String> ladder: ladders) {
//			System.out.println(ladder);
//		}
//		
//		System.out.println();
//		
//		start = "red";
//		end = "tax";
//
//		dict = new HashSet<String>();
//		dict.add("ted");
//		dict.add("tex");
//		dict.add("red");
//		dict.add("tax");
//		dict.add("tad");
//		dict.add("den");
//		dict.add("rex");
//		dict.add("pee");
//		
//		ladders = findLadders(start, end, dict);
//		for (ArrayList<String> ladder: ladders) {
//			System.out.println(ladder);
//		}

	}
}
