package wordBreakII;

import java.util.ArrayList;
import java.util.HashSet;
import java.util.Set;

public class StoreStartAndLength {
    public static ArrayList<String> wordBreak(String s, Set<String> dict) {
        ArrayList<String> result = new ArrayList<String>();
        
        boolean[][] dp = new boolean[s.length()][s.length() + 1];
        
        for (int len = 1; len <= s.length(); len++) {
            for (int i = 0; i < s.length() - len; i++) {
                int start = i;
                int end = i + len;
                
                if (dict.contains(s.substring(start, end))) {
                    dp[i][len] = true;
                } else {
                    for (int k = 1; k < len; k++) {
                        if (dp[i][k] && dp[i + k][len - k]) {
                            dp[i][len] = true;
                            break;
                        }
                    }
                }
            }
        }
        
        if (dp[0][s.length()]) {
            StringBuffer sb = new StringBuffer();
            helper(result, dp, s, 0, sb, dict);
        } 
        
        return result;
    }
    
    private static void helper(ArrayList<String> result, boolean[][] dp, String s, int start, StringBuffer sb, Set<String> dict) {
        if (start == dp.length) {
            result.add(sb.substring(0, sb.length() - 1));
        } else {
            for (int i = 1; i <= dp.length - start; i++) {
                if (dp[start][i]) {
                    String left = s.substring(start, start + i);
                    if (dict.contains(left)) {
                        if (i != dp.length - start && !dp[start + i][dp.length - start - i]) {
                            continue;
                        }
                        
                        int lastIndex = sb.length();
                        sb.append(left + " ");
                        helper(result, dp, s, start + i, sb, dict);
                        sb.delete(lastIndex, sb.length());
                    }
                }
            }
        }
    }
    
    
    public static void main(String[] args) {
    	String s = "a";
		Set<String> dict = new HashSet<>();
		dict.add("a");
		System.out.println(wordBreak(s, dict));
//		String s = "catsanddog";
//		Set<String> dict = new HashSet<>();
//		dict.add("cat");
//		dict.add("cats");
//		dict.add("and");
//		dict.add("sand");
//		dict.add("dog");
//		System.out.println(wordBreak(s, dict));

		// String s =
		// "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaav";
		// Set<String> dict = new HashSet<>();
		// dict.add("a");
		// dict.add("aa");
		// dict.add("aaa");
		// dict.add("aaaa");
		// dict.add("aaaaa");
		// dict.add("aaaaaa");
		// dict.add("aaaaaaa");
		// dict.add("aaaaaaaa");
		// dict.add("aaaaaaaaa");
		// dict.add("aaaaaaaaaa");

		// System.out.println(wordBreak(s, dict));
	}

}
