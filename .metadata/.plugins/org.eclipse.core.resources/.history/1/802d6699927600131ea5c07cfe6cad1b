package fourSum;

import java.util.ArrayList;
import java.util.Arrays;

public class RemoveDuplication {
	public ArrayList<ArrayList<Integer>> fourSum(int[] num, int target) {
		ArrayList<ArrayList<Integer>> results = new ArrayList<ArrayList<Integer>>();
		if (num == null || num.length < 4) {
			return results;
		}

		Arrays.sort(num);

		for (int i = 0; i < num.length; i++) {
			for (int j = i + 1; j < num.length; j++) {
				for (int k = j + 1, l = num.length - 1; k < l;) {
					int sum = num[i] + num[j] + num[k] + num[l];
					if (sum < target) {
						k++;
						while (k < num.length - 1 && num[k] == num[k - 1]) {
							k++;
						}
					} else if (sum > target) {
						l--;
						while (l > 0 && num[l] == num[l + 1]) {
							l--;
						}
					} else {
						ArrayList<Integer> result = new ArrayList<Integer>();
						result.add(num[i]);
						result.add(num[j]);
						result.add(num[k]);
						result.add(num[l]);
						results.add(result);
						k++;
						l--;
						while (k < num.length - 1 && num[k] == num[k - 1]) {
							k++;
						}

						while (l > 0 && num[l] == num[l + 1]) {
							l--;
						}
					}

				}

				while (j < num.length - 1 && num[j] == num[j + 1]) {
					j++;
				}
			}

			while (i < num.length - 1 && num[i] == num[i + 1]) {
				i++;
			}
		}

		return results;
	}
}
